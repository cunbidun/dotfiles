#!/bin/bash

# Dependency: xwininfo, xdotool
# Work without EWMH/NetWM

rootid=$(printf '%d' "$(xwininfo -root | grep "Window id" | cut -d ' ' -f 4)")
deskid=$(xdotool get_desktop)
wid=$(wmctrl -x -l | grep -E " $deskid " | grep -v $(printf '0x0%x' "$1") | dmenu -i -l 5 -p "Select: " | cut -d ' ' -f 1)
# wid=$(xwininfo | grep "Window id" | cut -d ' ' -f 4)
if [ -z "$wid" ]; then
	notify-send "tabbedize" "wid is empty. aborting"
	exit 0
fi

echo "wid is $wid"
wname=$(xwininfo -id "$wid" | grep 'Window id:' | cut -d ' ' -f 5-)
if [ "$wname" == "(has no name)" ]; then
	notify-send "tabbedize" "wname is empty. aborting"
	exit 0
fi

tabbed -c -d | xargs -I {} xdotool windowreparent "$wid" "{}"
